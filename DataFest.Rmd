---
title: "DataFest"
author: "Albert Sun and Ben Wallace"
date: "4/9/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r upload packages, results = "hide"}
library(dplyr)
library(ggplot2)
library(patchwork)
```

```{r read files}
counties <- read.csv("datafiles/us-counties.csv")
states <- read.csv("datafiles/us-states.csv")
measures <- read.csv("datafiles/statedata.csv")
```

```{r topten}
toptencounties <- counties %>%
  filter(date == "2020-04-08") %>%
  arrange(desc(cases))
  
toptencounties <- toptencounties[1:10,]

toptenstates <- states %>%
  filter(date == "2020-04-08") %>%
  arrange(desc(cases))

toptenstates <- toptenstates[1:10,]
```


```{r plot}
p1 <- ggplot(data = toptencounties, mapping = aes(x = reorder(county, cases), y = cases)) +
  geom_bar(stat = "identity") + 
  labs(title = "Top 10 Coronavirus counties cases", 
       y = "Cases", x = "County Name") + 
  coord_flip()

p2 <- ggplot(data = toptenstates, mapping = aes(x = reorder(state, cases), y = cases)) +
  geom_bar(stat = "identity") + 
  labs(title = "Top 10 Coronavirus states cases", 
       y = "Cases", x = "State Name") + 
  coord_flip() 

p1 + p2
```

```{r addmeasures} 
### Removing United States from df

measures <- measures[-c(1),]

dates <- c("4/4/2020 17:00", # Dates of stay at home orders
           "3/28/2020 17:00",
           "3/31/2020 17:00",
           "",
           "3/19/2020 0:00",
           "3/26/2020 6:00",
           "3/23/2020 20:00",
           "3/24/2020 8:00",
           "4/1/2020 0:01",
           "4/3/2020 0:01",
           "4/3/2020 0:00",
           "3/25/2020 0:01",
           "3/25/2020 13:30",
           "3/21/2020 17:00",
           "3/24/2020 23:59",
           "",
           "3/30/2020 0:01",
           "3/26/2020 20:00",
           "3/23/2020 17:00",
           "4/2/2020 0:01",
           "3/30/2020 20:00",
           "3/23/2020 12:00",
           "3/24/2020 0:01",
           "3/27/2020 23:59",
           "4/3/2020 17:00",
           "4/6/2020 0:01",
           "3/28/2020 0:01",
           "",
           "4/1/2020 0:00",
           "3/27/2020 23:59",
           "3/21/2020 21:00",
           "3/24/2020 8:00",
           "3/22/2020 20:00",
           "3/30/2020 15:00",
           "",
           "3/23/2020 23:59",
           "",
           "3/23/2020 0:00",
           "4/1/2020 20:00",
           "3/28/2020 0:00",
           "4/7/2020 17:00",
           "",
           "3/31/2020 23:59",
           "4/2/2020 0:01",
           "",
           "3/25/2020 17:00",
           "3/30/2020 0:00",
           "3/23/2020 0:00",
           "3/24/2020 20:00",
           "3/25/2020 8:00",
           ""
           )

### Adding data to measures df
measures <- measures %>%
  mutate(date.stay.at.home = dates)  %>%
  mutate(stateno = c(1:51))

```

```{r plotstayathome}
### Plot of stay at home dates

measures$date.stay.at.home = as.Date(measures$date.stay.at.home, "%m/%d/%y")
med <- median(measures$date.stay.at.home, na.rm = TRUE)
avg <- mean(measures$date.stay.at.home, na.rm = TRUE)

ggplot(data = measures, aes(x = date.stay.at.home)) +
         geom_histogram(stat = "count") +
   scale_x_date(breaks = "3 days") +
  theme(axis.text.x = element_text(angle = 90)) + 
  geom_vline(xintercept = med, color = "darkred") +
  geom_vline(xintercept = avg, color = "navy")

```
